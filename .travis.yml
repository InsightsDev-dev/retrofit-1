language: java

jdk:
  - oraclejdk8

after_success:
  -wget --content-disposition wget --content-disposition http://search.maven.org/remotecontent?filepath=org/jacoco/jacoco/0.7.7.201606060606/jacoco-0.7.7.201606060606.zip 
  -unzip -o jacoco-0.7.7.201606060606.zip  
  -cd lib  
  -mv * ../  
  -cd ..  
  -chmod a+x *  
  -cd $PWD  
  -rm  'jacoco.exec'
  -export JAVA_TOOL_OPTIONS=-javaagent:$PWD/jacocoagent.jar=destfile=$PWD/jacoco.exec,append=true  
  -travis_wait 360 mvn test  -Dmaven.test.failure.ignore=true -Djacoco.skip=true -Dcobertura.skip=true -Dmaven.clover.skip=true -Dmaven.javadoc.skip=true -Drat.skip=true -Drat.ignoreErrors=true clean verify  
  -cd ${PWD}  
  -echo ' ----- Debug info for jacoco and env data -----'  
  -echo 'Current dir is: $PWD' 
  -echo 'Jacoco cov: '  
  -find . -name '*.exec'  
  -echo '----------------------------------------------' 
  - ./df-build.sh
  - .buildscript/deploy_snapshot.sh

env:
  global:
    - secure: "M0bjPTMwinz0uXN6qjXcpyfvhz/YX9W7ty4RdV90jMU8ZJxSdGdKXRy1N0TsMO8ciOQ2fryE/FpiX+arrphnVvqUmGBh386lGvj1rhgrVqXNqlGE23cQpzHsQ0nNqTGIxnoE4dmJF3PjWoYG+B4WbFsSb3PB7sEjpLq7klqGeHk="
    - secure: "iL5BdYAmMaEDRKxNx1d9Zxn0tfJhCzXBGUvn+p7QGeQDUSVCdCc8cXS4ePbRj0401pK20nK1OouIi0lLP+z0QpZY6RrKIEncGOZeSFPQbS/vnZ7niCYJQdXCZ/GOlYUkAW2AsQl5bzzHYbHKX/TVgTuO3iFlbyeoZZuIjD3VaiM="

branches:
  except:
    - gh-pages

notifications:
  email: false

sudo: false

cache:
  directories:
    - $HOME/.m2
